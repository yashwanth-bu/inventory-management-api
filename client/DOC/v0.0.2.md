Perfect ðŸ‘
Below is your **Version 2 â€“ Frontend Logical Documentation**, written in the same structured format, but including **only the logical integration parts with backend** (no UI/UX details).

---

# Frontend Authentication & Inventory Integration (Version 2)

## 1. Overview

This frontend module integrates with the backend Authentication and Inventory APIs using:

* **React**
* **React Router**
* **Axios**
* **Session-based authentication**
* **Context API for global auth state**

It supports:

* User registration
* User login
* User logout
* Persistent session handling
* Protected routes
* User-scoped inventory access

---

## 2. Folder & File Structure (Frontend Logical Parts)

```
src/
â”‚
â”œâ”€ api/
â”‚   â”œâ”€ authApi.js            # Authentication API calls
â”‚   â””â”€ inventoryApi.js       # Inventory API calls
â”‚
â”œâ”€ context/
â”‚   â””â”€ AuthContext.jsx       # Global authentication state
â”‚
â”œâ”€ components/
â”‚   â””â”€ ProtectedRoute.jsx    # Route protection logic
â”‚
â”œâ”€ pages/
â”‚   â”œâ”€ LoginPage.jsx         # User login logic
â”‚   â”œâ”€ RegisterPage.jsx      # User registration logic
â”‚   â”œâ”€ InventoryPage.jsx     # Active inventory handling
â”‚   â””â”€ DeletedInventoryPage.jsx  # Deleted inventory handling
â”‚
â”œâ”€ App.jsx                   # Route configuration
â””â”€ main.jsx                  # Application bootstrap
```

---

## 3. Axios Configuration

### 3.1 Authentication API (`authApi.js`)

```javascript
const API = axios.create({
  baseURL: "http://localhost:3000/api/auth",
  withCredentials: true
});
```

**Reason:**

* `withCredentials: true` allows browser to send session cookies.
* Required for Passport session-based authentication.

### Available Methods:

* `registerUser(data)` â†’ `POST /register`
* `loginUser(data)` â†’ `POST /login`
* `logoutUser()` â†’ `DELETE /logout`
* `getCurrentUser()` â†’ `GET /me`

---

### 3.2 Inventory API (`inventoryApi.js`)

```javascript
const API = axios.create({
  baseURL: "http://localhost:3000/api/inventory",
  withCredentials: true
});
```

**Reason:**

* Inventory routes are protected by `isAuthenticated`.
* Session cookie must be sent with every request.

### Available Methods:

* `getAllInventory(params)`
* `getInventoryById(id)`
* `createInventory(data)`
* `updateInventory(id, data)`
* `deleteInventory(id)`
* `recoverInventory(id)`
* `getDeletedInventory()`

---

## 4. Global Authentication State (AuthContext)

### Purpose

Maintains authentication state across the application.

### Responsibilities

* Stores `isAuthenticated`
* Stores `loading` state during session check
* Provides `login()` and `logout()` functions
* Checks active session on application load

---

### Session Persistence Logic

On app load:

```javascript
useEffect(() => {
  const checkSession = async () => {
    try {
      await getCurrentUser();
      setIsAuthenticated(true);
    } catch {
      setIsAuthenticated(false);
    } finally {
      setLoading(false);
    }
  };

  checkSession();
}, []);
```

**Effect:**

* Prevents logout on refresh
* Validates session via `/api/auth/me`
* Ensures frontend state matches backend session

---

## 5. Protected Route Mechanism

`ProtectedRoute.jsx`:

```javascript
if (loading) return null;

if (!isAuthenticated) {
  return <Navigate to="/login" replace />;
}
```

### Behavior

* Blocks access to protected pages
* Redirects unauthenticated users to `/login`
* Waits until session check completes

---

## 6. Route Structure (App.jsx)

### Public Routes

* `/login`
* `/register`

### Protected Routes

* `/` â†’ InventoryPage
* `/deleted` â†’ DeletedInventoryPage

Protected routes are wrapped inside:

```javascript
<ProtectedRoute>
  ...
</ProtectedRoute>
```

---

## 7. Authentication Flow (Frontend â†” Backend)

### 7.1 Registration Flow

1. User submits email and password.
2. Frontend calls:

```
POST /api/auth/register
```

3. Backend validates with Zod.
4. Password hashed via bcrypt.
5. Success response returned.
6. User redirected to login.

---

### 7.2 Login Flow

1. User submits credentials.
2. Frontend calls:

```
POST /api/auth/login
```

3. Passport authenticates user.
4. Session created.
5. Cookie stored in browser.
6. `isAuthenticated` set to true.
7. Redirect to Inventory dashboard.

---

### 7.3 Refresh Handling

1. Page reloads.
2. AuthContext calls:

```
GET /api/auth/me
```

3. If session valid â†’ `isAuthenticated = true`
4. If not â†’ redirect to login.

---

### 7.4 Logout Flow

1. User clicks logout.
2. Frontend calls:

```
DELETE /api/auth/logout
```

3. Session destroyed.
4. `isAuthenticated = false`
5. Redirect to login.

---

## 8. Inventory Module Logic (User Scoped)

Inventory APIs are protected by:

```javascript
router.use(isAuthenticated);
```

Backend extracts user from session:

```javascript
req.user.id
```

All inventory queries use:

```
userId
```

Example:

```javascript
findByUserId(userId)
```

### Result:

* Each user sees only their own inventories.
* No userId sent from frontend.
* Session determines ownership.

---

## 9. Search Implementation

Frontend passes query parameters:

```javascript
getAllInventory({ name: searchTerm })
```

Backend reads:

```javascript
req.query.name
```

Returns filtered inventories belonging to authenticated user.

---

## 10. Security Alignment

Frontend respects backend rules:

* Password complexity enforced
* Session-based authentication
* No token storage in localStorage
* No userId exposed manually
* All protected routes guarded

---

## 11. Key Architectural Decisions

* Session-based auth (not JWT)
* Backend-driven validation
* Context-based global state
* ProtectedRoute pattern
* Persistent session validation on refresh
* Scoped data access per authenticated user

---



